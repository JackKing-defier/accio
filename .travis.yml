# Accio is a platform to launch computer science experiments.
# Copyright (C) 2016-2018 Vincent Primault <v.primault@ucl.ac.uk>
#
# Accio is free software: you can redistribute it and/or modify
# it under the terms of the GNU General Public License as published by
# the Free Software Foundation, either version 3 of the License, or
# (at your option) any later version.
#
# Accio is distributed in the hope that it will be useful,
# but WITHOUT ANY WARRANTY; without even the implied warranty of
# MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
# GNU General Public License for more details.
#
# You should have received a copy of the GNU General Public License
# along with Accio.  If not, see <http://www.gnu.org/licenses/>.

# Enables support for a docker container-based build which should provide faster startup times and beefier
# "machines". This is also required in order to use the cache configured below.
sudo: false

before_cache:
  # The `ivydata-*.properties` & root level `*.{properties,xml}` files' effect on resolution time is in the noise,
  # but they are re-timestamped in internal comments and fields on each run and this leads to travis-ci cache thrash.
  # Kill these files before the cache check to avoid un-needed cache re-packing and re-upload (a ~100s operation).
  - find $HOME/.ivy2/cache -type f -name "ivydata-*.properties" -print -delete
  - rm -fv $HOME/.ivy2/cache/*.{css,properties,xml,xsl}
  # The stats cache contains timestamped reports unused by CI but that
  # thrash the cache.  Skip caching these.
  - rm -rf $HOME/.cache/pants/stats

cache:
  directories:
    - $HOME/.cache/pants
    - $HOME/.ivy2/pants
    - $HOME/.ivy2/cache

language: scala
jdk: oraclejdk8
scala:
   - 2.11.8

script:
  - uname -a
  - java -version
  - echo $JAVA_HOME
  - "./pants test ::"